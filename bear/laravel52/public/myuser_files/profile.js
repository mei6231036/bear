$(document).ready(function(){var e,i,n,o=window.location.href,l=o.substr(0,o.lastIndexOf("/")+1);profile_util={errorDisplayInfo:function(e){var i=l+"index.php",n='<i class="icon icon-error"></i><span>'+e+"</span>",o=LEGO.popupBox("#popup-win17",{ok:function(){o.close()},existMask:!0,cancle:function(){window.location.replace(i)}},{});o.content(n),o.open()},stringBuild:function(e){return'<div style="display: block; height: 137px;" class="box-bd"><div class="mod-form"><div class="warning"><i></i><p>'+e+"</p></div></div></div>"},checkIsEmpty:function(e){var i=$("input#"+e+"Input").val(),n=!1;return"tel"!=e||profile_util.isTel(i)||(n=!0),""==$.trim(i)||n?($("i#"+e+"I").removeClass().addClass("error"),void $("input#"+e+"Input").removeClass().addClass("error").val("")):($("i#"+e+"I").removeClass(),void $("input#"+e+"Input").removeClass())},isTel:function(e){var i=/^([0-9]|[\-])+$/g;return e.length<5||e.length>18?!1:i.exec(e)},JcropAvatar:function(){$("#avatar_previewimg").Jcrop({boxWidth:330,boxHeight:500,setSelect:[0,0,140,140],onChange:profile_util.updatePreview,onSelect:profile_util.updatePreview,onSelect:profile_util.updateCoords,aspectRatio:1},function(){var o=this.getBounds();i=o[0],n=o[1],e=this})},updatePreview:function(e){var o=140/e.w,l=140/e.h;void 0!=i&&"undefined"!=i&&void 0!=n&&"undefined"!=n&&0!=e.w&&0!=e.h&&void 0!=l&&void 0!=o&&$("#avatarpreview2").css({width:Math.round(o*i)+"px",height:Math.round(l*n)+"px",marginLeft:"-"+Math.round(o*e.x)+"px",marginTop:"-"+Math.round(l*e.y)+"px"})},updateCoords:function(e){$("#x").val(e.x),$("#y").val(e.y),$("#w").val(e.w),$("#h").val(e.h)},previewImg:function(e,i,n,o,l){var t=document.createElement("img");t.src=e,t.width=i,void 0!=l&&0!=l&&l>0&&""!=l&&(t.height=l),t.id=n+"_previewimg",$("#"+n+"_preview img").remove(),$("#"+n+"_preview").append(t),$("#"+n+"_id").val(o)},saveJcropImg:function(e){$("#"+e+"_preview img").remove(),$("#"+e+"_preview").empty(),$("#"+e+"SureButton").hide(),$("#"+e+"FailButton").hide(),$("#avatar_upload_file-queue").remove(),$("#avatarpreviewdiv").css({"float":"left"});var o=$("#x").val(),l=$("#y").val(),t=$("#w").val(),a=$("#h").val();return $("#xywh").val(o+","+l+","+t+","+a),i=n=void 0,!1},cancelJcropImg:function(e){return $("#"+e+"_preview img").remove(),$("#"+e+"_preview").empty(),$("#"+e+"SureButton").hide(),$("#"+e+"FailButton").hide(),$("#x").val(0),$("#y").val(0),$("#w").val(140),$("#h").val(140),$("#xywh").val(""),$("#"+e+"_id").val(""),$("#"+e+"previewdiv").hide(),$("#avatarpreview2").attr("src",""),$("#avatarpreview2").removeAttr("style"),$("#user_old_avatar").show(),i=n=void 0,!1},checkForm:function(e){return"0"==$("#issignChannel").val()?($("#signChannelInput").focus(),!1):profile_util.checkOwnRule(e)?!0:!1},checkOwnRule:function(e){for(var i=e.getElementsByTagName("input"),n=0;n<i.length;n++)if("false"==i[n].getAttribute("allownull")){var o=i[n].getAttribute("name");if(""==i[n].value)return $("i#"+o+"I").removeClass().addClass("error"),$("input#"+o+"Input").removeClass().addClass("error").val(""),i[n].focus(),!1;$("i#"+o+"I").removeClass().addClass("success"),$("input#"+o+"Input").removeClass()}return!0},setUnSignVerifyValue:function(){var e=$.trim($("input[name='unSignVerifyType']:checked").val());1==e?($("#force").hide(),$("#consult").show()):2==e&&($("#force").show(),$("#consult").hide()),$("#unSignVerify_value").val(e)},insertvalue:function(){var e=$.trim($("#channelId_input").val());$("#channelId_value").val(e)},ajaxSignProfile:function(e,i){var n=window.location.href,o=l+"index.php?m=ProfileSign&do=addVerifyProfile";if(""!=e)var t=e;else var t=$("#channelId_value").val();return""==t?profile_util.displayInfo(!1,"失败：请输入频道号码",n):isNaN(i)||""==i?profile_util.displayInfo(!1,"失败：签约时限不能为空",n):void $.post(o,{channel:t,selecttime:i},function(e){if(e.status){var i="提交成功";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(i+=","+e.msg),profile_util.displayInfo(!0,i,n)}else{var o="失败:";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(o+=e.msg),profile_util.displayInfo(!1,o,n)}},"json")},insertIsAgree:function(e){$("#is_agree_value").val(e)},platinumWindow:function(e,i,n,o,l){var t=LEGO.popupBox("#popup-win22",{ok:function(){profile_util.unplatinumWindow(e,i,n,o,l),t.close()},existMask:!0,cancle:function(){t.close()}},{});t.open()},dealSignInviteWindow:function(e,i){var n=window.location.href,o=l+"index.php?m=ProfileSign&do=querySignInvitePercent",t=l+"index.php?m=ProfileSign&do=checkVerifyProfile",a=l+"index.php?m=ProfileSign&do=checkChannel";$.post(a,{channel:e},function(l){l?profile_util.platinumWindow(e,i,o,t,n):profile_util.unplatinumWindow(e,i,o,t,n)},"json")},unplatinumWindow:function(e,i,n,o,t){$.post(o,{},function(o){if(o.status)$.post(n,{channelId:e,uid:i},function(i){if(i.status){{var n=i.data.percent,o=i.data.isPlatinumUnion,a=i.data.shortChannel,r=i.data.sign_time_str;i.data.selecttime}if(o)var s=100-n;else var s=70,p=100-n;var u='<div class="form-group">您确定与该频道签约？</div><div class="form-group"><label class="tit">频道号：</label><input type="text" class="num-input"  id="channelId_input" value="'+a+'" disabled/></div><div class="form-group"><label class="tit">主播提成比例：</label><span class="inline-text">'+s+'%</span></div><div class="form-group"><label class="tit">签约时限：</label><span class="inline-text">'+r+"</span>";o||(u=u+'<div class="form-group"><label class="tit">成为白金公会后主播提成：</label><span class="inline-text">'+p+"%</span></div>"),u+="</div>";var d=LEGO.popupBox("#popup-win24",{ok:function(){var i=l+"index.php?m=ProfileSign&do=profilePassOwInviteSign";$.getJSON(i,{channelId:e},function(e){var i="";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(i+=e.msg),profile_util.displayInfo(!1,i,t),$("body").scrollTop(0),$(window).scrollTop(0)}),d.close()},existMask:!0,cancle:function(){var i=l+"index.php?m=ProfileSign&do=profileRejectUserOwInviteSign";$.getJSON(i,{channelId:e},function(e){var i="";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(i+=e.msg),profile_util.displayInfo(!1,i,t),$("body").scrollTop(0),$(window).scrollTop(0)}),d.close()}},{});d.content(u),d.open()}else{var v="提交失败";""!=i.msg&&null!=i.msg&&void 0!=i.msg&&(v=i.msg),i.confim?profile_util.displayInfo(!1,v,t,10):profile_util.displayInfo(!1,v,t)}},"json");else{var a="";""!=o.msg&&null!=o.msg&&void 0!=o.msg&&(a+=o.msg),profile_util.displayInfo(!1,a,t)}},"json")},unretrieveProfile:function(e){if(""==e)return void profile_util.displayInfo(!1,"参数错误","");var i=l+"index.php?m=ProfileInfo",n=l+"index.php?m=ProfileInfo&do=unretrieveProfile";$.post(n,{uid:e},function(e){if(e.status){var n="成功";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(n=e.msg),profile_util.displayInfo(!0,n,i)}else{var o="失败";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(o=e.msg),profile_util.displayInfo(!1,o,i)}},"json")},displayInfo:function(e,i,n){var o="";o=e?'<i class="icon icon-success"></i><span>'+i+"</span>":'<i class="icon icon-error"></i><span>'+i+"</span>",""==n&&(n=l+"index.php?m=ProfileSetting");var t=LEGO.popupBox("#popup-win17",{ok:function(){t.close()},existMask:!0,cancle:function(){window.location.replace(e?n:n),window.location.reload()}},{});t.content(o),t.open()},insertMedalLink:function(){var e=$.trim($("#medal_link_input").val());$("#medal_link_value").val(e)},postUserUpdate:function(){var e=l+"index.php?m=ProfileSetting&do=postUserUpdate",i=l+"index.php?m=ProfileSetting",n=$("input#content_input").val(),o=$("input#yy_id_input").val(),t=$("input#avatar_id").val(),a=$("#x").val(),r=$("#y").val(),s=$("#w").val(),p=$("#h").val(),u=a+","+r+","+s+","+p,d=$("input#post_id").val();$.getJSON(e,{content:n,yy_id:o,avatar_id:t,xywh:u,post_id:d},function(e){if(e.status){var n="提交成功";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(n+=","+e.msg),profile_util.displayInfo(!0,n,i)}else{var o="失败:";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(o+=e.msg),profile_util.displayInfo(!1,o,i)}$("body").scrollTop(0),$(window).scrollTop(0)})},ajaxGreenbeanExchangeWhitebean:function(){var e=l+"index.php?m=MyAccount&do=exchangeWhitebean#",i=l+"index.php?m=MyAccount&do=doExchangeWhitebean",n=$("li.selected input:hidden").val();if(void 0==n)return void profile_util.displayInfo(!1,"请您选择要兑换的银豆礼包！",e);var o=$("#gift_num").val(),t=$("#greenbean_price_"+n).html(),a=$("#csrfToken").val(),r=t*o,s=$("#total_greenbean").html();return r>s?void profile_util.displayInfo(!1,"很抱歉，您的金豆不够！",e):void $.post(i,{giftId:n,num:o,csrfToken:a},function(i){if(i.status){var n="恭喜，兑换银豆礼包成功！";""!=i.msg&&null!=i.msg&&void 0!=i.msg&&(n=i.msg),profile_util.displayInfo(!0,n,e)}else{if("recheck"===i.msg){var o=l+"udb_web/udb2caport.php?do=wakeup&type=buywhitebean";return void safetyVerifyUtil.showPopupBox({url:o})}var t="抱歉，兑换银豆礼包失败！";""!=i.msg&&null!=i.msg&&void 0!=i.msg&&(t=i.msg),profile_util.displayInfo(!1,t,e)}},"json")},ajaxGreenbeanExchangeWhitebeanForCode:function(e){var i=l+"index.php?m=MyAccount&do=exchangeWhitebean#",n=l+"index.php?m=MyAccount&do=doExchangeWhitebean",o=$("li.selected input:hidden").val();if(void 0==o)return void profile_util.displayInfo(!1,"请您选择要兑换的银豆礼包！",i);var t=$("#gift_num").val(),a=$("#greenbean_price_"+o).html(),r=$("#csrfToken").val(),s=a*t,p=$("#total_greenbean").html();return s>p?void profile_util.displayInfo(!1,"很抱歉，您的金豆不够！",i):void $.post(n,{giftId:o,num:t,csrfToken:r,cacode:e},function(e){if(e.status){var n="恭喜，兑换银豆礼包成功！";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(n=e.msg),profile_util.displayInfo(!0,n,i)}else{if("recheck"===e.msg){var o=l+"udb_web/udb2caport.php?do=wakeup&type=buywhitebean";return void safetyVerifyUtil.showPopupBox({url:o})}var t="抱歉，兑换银豆礼包失败！";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(t=e.msg),profile_util.displayInfo(!1,t,i)}},"json")},insertgreenbeanvalue:function(){var e=$.trim($("#credits_input").val());$("#credits_value").val(e),document.getElementById("greenbeancountdown").innerHTML=e},insertunfreezevalue:function(){var e=$.trim($("#deposit_input").val());$("#deposit_value").val(e),document.getElementById("unfreezecountdown").innerHTML=e},dealUpdatePercentWindow:function(e,i){var n=LEGO.popupBox("#popup-win21",{ok:function(){profile_util.dealUpdatePercent(e,i),n.close()},existMask:!0,cancle:function(){n.close()}},{});n.open()},dealUpdatePercent:function(e,i){var n=l+"index.php?m=ProfileSign&do=dealUpdatePercent",o=window.location.href,t=parseInt($.trim($("#is_agree_value").val()));return 1!=t&&0!=t?profile_util.displayInfo(!1,"请选择同意或者不同意！",o):void $.post(n,{channelId:e,uid:i,isAgree:t},function(e){if(e.status){var i="提交成功";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(i=e.msg),profile_util.displayInfo(!0,i,o)}else{var n="提交失败";""!=e.msg&&null!=e.msg&&void 0!=e.msg&&(n=e.msg),profile_util.displayInfo(!1,n,o)}},"json")},refreshProfileInfo:function(){var e=l+"index.php?m=Profile",i=l+"index.php?m=ProfileInfo&do=refreshProfileInfo";$.post(i,{},function(i){if(i.status){var n="成功";""!=i.msg&&null!=i.msg&&void 0!=i.msg&&(n=i.msg),profile_util.displayInfo(!0,n,e)}else{var o="失败";""!=i.msg&&null!=i.msg&&void 0!=i.msg&&(o=i.msg),profile_util.displayInfo(!1,o,e)}},"json")}}});